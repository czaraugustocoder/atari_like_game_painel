<html>
    <head>
        <meta charset="utf-8">
        <title>Bomberman</title>

        <style>
            #tela {
                border: 5px solid #CCC;
                image-rendering: pixelated;
                image-rendering: crisp-edges;
                image-rendering: -moz-crisp-edges;
                width: 400px;
                height: 400px;
            }
        </style>
    </head>
    <body>
        <canvas id="tela" width="20" height="20"></canvas>

        <script>
            const tela = document.getElementById("tela");
            const context = tela.getContext("2d");

            const game = {
                jogadores: {
                    'jogador1': { x: 0, y: 0 },
                    'jogador2': { x: 0, y: 19 },
                    'jogador3': { x: 19, y: 0 },
                    'jogador4': { x: 19, y: 19 }
                },
                frutas: {
                'fruta': { x: 10, y: 10 }
                }
            }

            document.addEventListener('keydown', handleKeydown);

            function handleKeydown(event) {
                const keyPressed = event.key
                const gamer = game.jogadores['jogador1']

                if (keyPressed === "ArrowUp" && gamer.y > 0) {
                    console.log("up")
                    let y = gamer.y - 1
                    let coord_game = `${gamer.x},${y}`;
                    console.log(coord_game)
                    if (coords.includes(coord_game) === false) {
                        console.log(coords.includes(coord_game));
                        gamer.y = gamer.y - 1
                    }

                    renderTela(game)

                }

                if (keyPressed === "ArrowRight" && gamer.x < 19) {
                    console.log("right")
                    let x = gamer.x + 1
                    let coord_game = `${x},${gamer.y}`;
                    console.log(coord_game)
                    if (coords.includes(coord_game) === false) {
                        console.log(coords.includes(coord_game));
                        gamer.x = gamer.x + 1
                    }

                    renderTela(game)
                }

                if (keyPressed === "ArrowLeft" && gamer.x > 0) {
                    console.log("left")
                    let x = gamer.x - 1
                    let coord_game = `${x},${gamer.y}`;
                    console.log(coord_game)
                    if (coords.includes(coord_game) === false) {
                        console.log(coords.includes(coord_game));
                        gamer.x = gamer.x - 1
                    }

                    renderTela(game)
                }

                if (keyPressed === "ArrowDown" && gamer.y < 19) {
                    console.log("down")
                    let y = gamer.y + 1
                    let coord_game = `${gamer.x},${y}`;
                    console.log(coord_game)
                    if (coords.includes(coord_game) === false) {
                        console.log(coords.includes(coord_game));
                        gamer.y = gamer.y + 1
                    }

                    renderTela(game)
                }

            }

            let coords = []

            renderTela(game)

            function renderTela(game) {
                coords = []
                context.fillStyle = "white"
                context.clearRect(0, 0, 20, 20)

                const lab = [
                [0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0],
                [0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0],
                [0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1,1,1,0,0],
                [0,1,1,1,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0],
                [0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0],
                [0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0],
                [1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,1],
                [0,0,0,1,0,1,1,1,0,1,0,0,0,1,1,1,0,0,0,0],
                [0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,1,0],
                [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0],
                [0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0],
                [0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0],
                [0,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0],
                [0,0,0,1,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0],
                [0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,1,0,0],
                [1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0],
                [0,0,0,1,0,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0],
                [0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0],
                [0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0]
                ]

                let cont_linha = 0;
                let cont_ponto = 0;

                for (linha in lab) {
                    pontos = lab[linha]
                    cont_ponto = 0
                    for (ponto in pontos) {
                        if (lab[linha][ponto] == 1) {
                            context.fillStyle = "black";
                            const coord = `${cont_ponto},${cont_linha}`;
                            coords.push(coord);
                            context.fillRect(cont_ponto, cont_linha, 1, 1);
                        }
                        cont_ponto += 1
                    }
                    cont_linha += 1
                }

                console.log(coords)

                for (jogadorId in game.jogadores) {
                    const jogador = game.jogadores[jogadorId];
                    context.fillStyle = "blue";
                    context.fillRect(jogador.x, jogador.y, 1, 1);
                }

                for (frutaId in game.frutas) {
                    const fruta = game.frutas[frutaId];
                    context.fillStyle = "green";
                    context.fillRect(fruta.x, fruta.y, 1, 1);
                }

        }
        </script>
    </body>
</html>